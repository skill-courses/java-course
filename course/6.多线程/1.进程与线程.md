# 进程与线程

![press_vs_thread](https://tva1.sinaimg.cn/large/008eGmZEly1gmiz1fn9ytg30ty0l775l.gif)

## 进程与线程

**计算机中能够单独运行的任务程序称之为进程**。比如我们电脑上面登陆的QQ,微信，Word文档编辑器，浏览器等都是单独运行的程序，可以认为他们是进程。在Windows电脑中，我们可以在`任务管理器`中查看当前运行的所有进程。进程有个主要的特点就是：拥有独立的物理内存空间，里面可以为此进程存储单独的数据，文件等相关信息，**进程是资源分配的最小单位**。通常情况下，一个进程可以包含多个线程，但至少要包含一个线程。

**计算机中能够被CPU调度的逻辑控制单位称之为线程**。单个线程无法独立运行，必须寄生于进程来执行。线程没有独立的物理内存空间，多个线程共享一个进程中的内存空间中的数据，文件等，这就好比一辆火车，这辆火车本身就是一个能够独立运行的进程(因为火车本身就可以跑)，但是火车光能跑还不行，必须需要有车厢才能实现拉人拖货等功能，那么车厢就是线程。

![trains](https://tva1.sinaimg.cn/large/008eGmZEly1gmizonkwo4j30e8074dgf.jpg)

### 进程与线程的区别与联系

#### 联系

* 一个进程必须包含一个或者多个线程
* 线程必须依赖于进程而存在

#### 区别

* 进程有独立的内存区域，拥有独立的数据访问权
* 多个进程之间互相不干扰
* 线程共享进程的内存区域和数据
* 多个线程之间会争抢共享的数据和资源

![single-vs-mutli-threaded-process](https://tva1.sinaimg.cn/large/008eGmZEly1gmiztdhvk4j30xc0gd427.jpg)

### 线程与CPU

现在，多核CPU已经非常普及了，我们购买手机或者电脑，都会关注CPU的核数，主要是因为，多核CPU可以独立的运行线程，假设你的电脑上面仅仅开了两个进程，一个是QQ软件，另一个是Word文档，如果你是四核的CPU，理论上，这两个任务将会被独立的CPU处理。即使过去的单核CPU，也可以执行多任务。由于CPU执行代码都是顺序执行的，那么，单核CPU是怎么执行多任务的呢？

答案就是操作系统轮流让各个任务交替执行，任务1执行0.01秒，切换到任务2，任务2执行0.01秒，再切换到任务3，执行0.01秒……这样反复执行下去。表面上看，每个任务都是交替执行的，但是，由于CPU的执行速度实在是太快了，我们感觉就像所有任务都在同时执行一样。

真正的并行执行多任务只能在多核CPU上实现，但是，由于任务数量远远多于CPU的核心数量，所以，操作系统也会自动把很多任务轮流调度到每个核心上执行。

## 单线程与多线程

从上面的学习中可以知道，每个进程至少有一个线程，所以，如果一个进程仅仅只有一个线程来处理工作任务，称为单线程。同理，在一个程序中同时运行多个不同的线程来执行不同的任务，那么这就叫做多线程。举个简单的例子，你早上上班，正要打卡的时候，手机响了。。你如果先接了电话，等接完了，再打卡，就是单线程。如果你一手接电话，一手打卡，就是多线程，2件事的结果是一样的，你接了电话且打了卡。

放到软件中来看，如果你打开了一个Word文档，开始写一些资料，在你写作的同时，Word文档给你开启了拼写检查，当你输入一段文字的时候，如果有语法或者单词拼写错误，Word就会给你提示。这里，向Word文档输入资料就是一个线程，拼写检查是另一个线程，两个线程独立运行，结果就是你在完成写作的同时，拼写检查也相应的完成了工作。

### 多线程的优势

多线程的优势相当明显，主要有以下几个方面：

* 大大提高CPU的利用率，多个线程同时进行，让空闲的CPU忙碌起来。
* 提升软件的用户体验，上面Word文档的例子中就可以看出来。

当然，多线程也不是万能的，用的好可以尝到多线程的甜头，用的不好，只能自找麻烦，因为多线程也有以下弊端：

* 线程之间是可以共享资源的，这就意味着多个线程之间会存在争抢资源的情况，设计不好就非常容易导致死锁的产生。
* CPU在多个线程之间切换也是需要资源消耗的，线程在运行的时候，需要从计算机里得到一些资源，除了CPU，线程还需要一些内存来维持它本地的堆栈，还需要占用操作系统中的一些资源来管理线程。

那么，如果利用好多线程给我们带来的优势的同时避免其缺陷呢？接下来的课程将会给你带来收获！
