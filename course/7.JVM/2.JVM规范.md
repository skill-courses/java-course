# [JVM规范](https://docs.oracle.com/javase/specs/jvms/se8/html/index.html)

![JVM-specification](https://i.loli.net/2021/04/20/GAafUbWJPHke5DV.jpg)

通过前面的学习，知道JVM就是把class文件编译成操作系统能够识别并处理的指令，然后调用操作系统的接口来完成程序的执行逻辑。所以，JVM的输入就是class文件，输出就是操作系统的指令，是属于class文件与操作系统对接的桥梁。

![java-stucture](https://i.loli.net/2021/04/20/f21cqGbx3woz6Ng.png)

JVM的口号是“一次编译，到处运行！”，这就意味着，任何语言(不限于Java，其他如JRuby，JPython等)只要编码成符合JVM规范的class文件，就可以被JVM的类加载器加载并处理。任何开源厂商，只要按照JVM规范实现的虚拟机(HotSpot, J9等)都可以识别class文件，并且可以在任何平上运行。

**所以，JVM规范就是保证Java编译后的文件能够不受平台约束而执行的一种实现范式。**

## JVM规范的主要内容

如果你想了解JVM规范的详细内容，请点击这里：[The Java® Virtual Machine Specification](https://docs.oracle.com/javase/specs/jvms/se8/html/index.html),进行阅读。

上面的HTML网页包含了太多信息，下面我们对每个章节的内容做个简单介绍，方便大家以后阅读和查阅。

### 第一章：引言

主要介绍一些历史以及Java虚拟机的基础知识，还有各章节提要。

### 第二章：Java虚拟机结构

介绍了Class文件格式、数据类型、原始类型、引用类型、运行时数据区、栈帧、字节码指令等。

在这一部分中，我们比较熟悉的就是运行时数据区了。其实我们习惯性叫Java虚拟机内存模型或内存结构，但在JVM规范中是叫做运行时数据区的。此外栈帧也是非常重要的一个部分，与方法的调用有关。字节码指令则是更加深层次的知识。

此外，数据类型、原始类型、引用类型等也是基础的知识，但用得相对较少。

### 第三章：为Java虚拟机编译

写的是如何编译Java文件的，将Java文件编译为字节码文件，最终提供给Java虚拟机使用。

### 第四章：Class文件格式

前面提到过JVM的输入物料是字节码文件，也就是Class文件，而不是Java文件。也就是说无论是Java语言，还是php语言，只要你能编译出字节码文件，那JVM就能够运行。

那么我们就知道这个Class文件必定是有统一格式的。而这一章节说的内容就是Class文件的格式构成。

### 第五章：加载、链接与初始化

本章节主要内容是讲解JVM如何将字节码文件加载到内存中运行，其中包括了验证，准备和解析，之后是初始化，会运行一些初始化的构造方法，用于初始化数据。最后运行完毕，JVM退出。

### 第六章：Java虚拟机指令集

指令集，其实就是一系列指令的集合。例如我们需要给一个局部变量赋予1这个值，即这个动作：int a = 1; 在我们看来，这很简单，但对于机器来说需要很多个动作。

所以Java虚拟机指令集就是将这些常用的动作集中起来，定义成一系列指令，方便我们能使用。

